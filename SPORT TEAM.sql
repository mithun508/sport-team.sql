CREATE DATABASE IPL;
USE IPL;
CREATE TABLE COACHES(
COACH_ID INT PRIMARY KEY,
COACH_NAME VARCHAR(100),
COACH_AGE INT
);
INSERT INTO COACHES(COACH_ID,COACH_NAME,COACH_AGE) VALUES
(001,'MARK',40),
(002,'STEPHEN',41),
(003,'RICKY',45),
(004,'VIKRAM',42),
(005,'SHREYAS',44),
(006,'JUSTIN',45),
(007,'KUMAR',40),
(008,'DANIEL',46);
SELECT*FROM COACHES;

CREATE TABLE TEAMS (
TEAM_ID INT PRIMARY KEY AUTO_INCREMENT,
TEAM_NAME VARCHAR(100) NOT NULL,
CITY VARCHAR(100),COACH_ID INT,
FOREIGN KEY (COACH_ID) REFERENCES COACHES(COACH_ID)
);
INSERT INTO TEAMS(TEAM_ID,TEAM_NAME,CITY,COACH_ID)VALUES
(100,'MI','MUMBAI',001),
(200,'CSK','CHENNAI',002),
(300,'DC','DELHI',003),
(400,'KKR','KOLKATA',004),
(500,'GT','GUJARAT',005),
(600,'LSG','GUJARAT',006),
(700,'RR','GUJARAT',007),
(800,'SRH','GUJARAT',008);
SELECT*FROM TEAMS;

CREATE TABLE PLAYERS (
PLAYER_ID INT PRIMARY KEY AUTO_INCREMENT,
FIRST_NAME VARCHAR(50) NOT NULL,AGE INT,TEAM_ID INT,
FOREIGN KEY (TEAM_ID) REFERENCES TEAMS(TEAM_ID)
);
INSERT INTO PLAYERS(
FIRST_NAME,AGE,TEAM_ID)VALUES
('ROHIT SHARMA',36,100),
('SURYAKUMAR YADAV',33,100),
('HARDIK PANYA',30,100),
('BUMRAH',30,100),
('RUTURAJ',26,200),
('MS DHONI',42,200),
('JADEJA',35,200),
('MUKESH',27,200),
('DAVID WARNER',37,300),
('RISHABH PANT',26,300),
('MITCHELL',32,300),
('SHREYAS IYER',29,400),
('VARUN',32,400),
('ANUKUL',25,400),
('GILL',24,500),
('DAVID MILLER',34,500),
('SUDHARSAN',22,500),
('KL RAHUL',32,600),
('KRISHNAPPA',22,600),
('PANDYA',33,600),
('ASWIN',32,700),
('BUTTLER',30,700),
('SANJU',26,700),
('TRAVIS',29,800),
('NATARAJ',28,800),
('PAT',34,800);
SELECT*FROM PLAYERS;

CREATE TABLE MATCHES (
MATCH_ID INT PRIMARY KEY AUTO_INCREMENT,
TEAM1_NAME VARCHAR(50) NOT NULL,TEAM2_NAME VARCHAR(50)NOT NULL,
MATCH_DATE DATE,
MATCH_TIME TIME,VENUE VARCHAR(100)
);

INSERT INTO MATCHES(TEAM1_NAME,TEAM2_NAME,MATCH_DATE,MATCH_TIME,VENUE)VALUE
('MI','DC','10-05-24','3:00','CHENNAI'),
('CSK','KKR','10-05-24','6:30','KOLKATA'),
('MI','LSG','12-05-24','3:00','HYDERABAD'),
('DC','RR','12-05-24','6:30','CHENNAI'),
('SRH','GT','15-05-24','3:00','MUMBAI'),
('GT','KKR','15-05-24','6:30','KOLKATA'),
('CSK','MI','17-05-24','3:30','MUMBAI'),
('SRH','DC','17-05-24','6:30','HYDERABAD'),
('LSG','CSK','19-05-24','3:30','KOLKATA'),
('GT','MI','19-05-24','6:30','CHENNAI'),
('DC','RR','21-05-24','3:30','MUMBAI'),
('CSK','LSG','21-05-24','6:30','CHENNAI');
SELECT*FROM MATCHES;
SELECT* FROM TEAMS;

SELECT T.TEAM_NAME, T.CITY, C.COACH_NAME, C.COACH_AGE
FROM TEAMS T
INNER JOIN COACHES C ON T.COACH_ID = C.COACH_ID;

SELECT M.MATCH_ID, M.TEAM1_NAME AS TEAM1, M.TEAM2_NAME AS TEAM2, M.MATCH_DATE, M.MATCH_TIME, M.VENUE
FROM MATCHES M;
SELECT P.FIRST_NAME AS PLAYERNAME, P.AGE AS PLAYERAGE, T.TEAM_NAME AS TEAMNAME
FROM PLAYERS P
INNER JOIN TEAMS T ON P.TEAM_ID = T.TEAM_ID;

CREATE TABLE SCOREBOARD (
SCORE_ID INT PRIMARY KEY AUTO_INCREMENT,TEAM_NAME VARCHAR(50) NOT NULL,
RUNS INT NOT NULL,WICKETS INT NOT NULL
);
INSERT INTO SCOREBOARD (TEAM_NAME, RUNS, WICKETS) VALUES
('MI', 182, 6),
('DC', 175, 8),
('CSK', 198, 5),
('KKR', 190, 7),
('MI', 210, 4),
('LSG', 203, 9),
('DC', 178, 7),
('RR', 165, 9),
('SRH', 190, 6),
('GT', 183, 8),
('GT', 200, 3),
('KKR', 195, 9);

SELECT M.MATCH_ID, M.MATCH_DATE, M.VENUE, S.TEAM_NAME, S.RUNS, S.WICKETS
FROM MATCHES M
INNER JOIN SCOREBOARD S 
ON S.TEAM_NAME = M.TEAM1_NAME OR S.TEAM_NAME = M.TEAM2_NAME
WHERE M.VENUE = 'CHENNAI';

DELIMITER $$

CREATE PROCEDURE GETMATCHSUMMARY(IN VENUE_NAME VARCHAR(100))
BEGIN
SELECT M.MATCH_ID, M.MATCH_DATE, M.MATCH_TIME, M.VENUE, 
S.TEAM_NAME, S.RUNS, S.WICKETS
FROM MATCHES M INNER JOIN SCOREBOARD S 
ON S.TEAM_NAME = M.TEAM1_NAME OR S.TEAM_NAME = M.TEAM2_NAME
WHERE M.VENUE = VENUE_NAME;
END $$

DELIMITER ;
